#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Anthropic æç¤ºå·¥ç¨‹æ•™ç¨‹ç­”æ¡ˆé”® - HTMLè½¬Excelè½¬æ¢å™¨
å°†HTMLæ ¼å¼çš„æ•™ç¨‹ç­”æ¡ˆé”®è½¬æ¢ä¸ºExcelæ–‡ä»¶
"""

import pandas as pd
from bs4 import BeautifulSoup
import openpyxl
from openpyxl.styles import Font, PatternFill, Alignment, Border, Side
from openpyxl.utils.dataframe import dataframe_to_rows
import os

def create_excel_from_data():
    """ç›´æ¥ä»æ•°æ®åˆ›å»ºExcelæ–‡ä»¶"""
    
    # å‡†å¤‡æ•°æ®
    data = [
        ["", "æ¬¢è¿æ¥åˆ°æç¤ºå·¥ç¨‹äº¤äº’å¼æ•™ç¨‹", "", ""],
        ["", "æ³¨æ„ï¼šè¿™æ˜¯æ•™ç¨‹çš„éäº¤äº’å¼ç­”æ¡ˆé”®ï¼æ‚¨å°†æ— æ³•åœ¨æ­¤è¡¨æ ¼ä¸­ä¸Claudeè¿›è¡Œäº¤äº’ã€‚", "", ""],
        ["", "", "", ""],
        ["", "è¯¾ç¨‹ä»‹ç»å’Œç›®æ ‡", "", ""],
        ["", "æœ¬è¯¾ç¨‹æ—¨åœ¨ä¸ºæ‚¨æä¾›å…¨é¢çš„é€æ­¥æŒ‡å¯¼ï¼Œæ•™æ‚¨å¦‚ä½•åœ¨Claudeä¸­è®¾è®¡æœ€ä¼˜çš„æç¤ºè¯ã€‚", "", ""],
        ["", "å®Œæˆæœ¬è¯¾ç¨‹åï¼Œæ‚¨å°†èƒ½å¤Ÿï¼š", "", ""],
        ["", "âœ“ æŒæ¡ä¼˜ç§€æç¤ºè¯çš„åŸºæœ¬ç»“æ„", "", ""],
        ["", "âœ“ è¯†åˆ«å¸¸è§å¤±è´¥æ¨¡å¼å¹¶å­¦ä¹ è§£å†³è¿™äº›é—®é¢˜çš„\"80/20\"æŠ€å·§", "", ""],
        ["", "âœ“ äº†è§£Claudeçš„ä¼˜åŠ¿å’Œå±€é™æ€§", "", ""],
        ["", "âœ“ ä»é›¶å¼€å§‹ä¸ºå¸¸è§ç”¨ä¾‹æ„å»ºå¼ºå¤§çš„æç¤ºè¯", "", ""],
        ["", "", "", ""],
        ["", "è¯¾ç¨‹ç»“æ„å’Œå†…å®¹", "", ""],
        ["", "æœ¬è¯¾ç¨‹çš„ç»“æ„è®¾è®¡è®©æ‚¨æœ‰å¾ˆå¤šæœºä¼šäº²è‡ªç»ƒä¹ ç¼–å†™å’Œè°ƒè¯•æç¤ºè¯ã€‚", "", ""],
        ["", "è¯¾ç¨‹åˆ†ä¸º9ä¸ªç« èŠ‚å’Œé…å¥—ç»ƒä¹ ï¼Œä»¥åŠä¸€ä¸ªåŒ…å«æ›´é«˜çº§æ–¹æ³•çš„é™„å½•ã€‚", "", ""],
        ["", "å»ºè®®æ‚¨æŒ‰ç« èŠ‚é¡ºåºå­¦ä¹ è¯¾ç¨‹ã€‚", "", ""],
        ["", "", "", ""],
        ["", "åˆçº§", "", ""],
        ["1", "ç¬¬1ç« ï¼šåŸºæœ¬æç¤ºè¯ç»“æ„", "ç« èŠ‚", ""],
        ["", "è¯¾ç¨‹", "è¯¾ç¨‹å†…å®¹", "å­¦ä¹ æç¤ºè¯çš„åŸºæœ¬æ„æˆè¦ç´ "],
        ["", "ç»ƒä¹ ", "å®è·µç»ƒä¹ ", "åŠ¨æ‰‹ç»ƒä¹ åŸºæœ¬æç¤ºè¯ç»“æ„"],
        ["2", "ç¬¬2ç« ï¼šæ¸…æ™°ç›´æ¥çš„è¡¨è¾¾", "ç« èŠ‚", ""],
        ["", "è¯¾ç¨‹", "è¯¾ç¨‹å†…å®¹", "å­¦ä¹ å¦‚ä½•ä½¿æç¤ºè¯æ›´åŠ æ¸…æ™°æ˜ç¡®"],
        ["", "ç»ƒä¹ ", "å®è·µç»ƒä¹ ", "ç»ƒä¹ ç¼–å†™æ¸…æ™°ç›´æ¥çš„æç¤ºè¯"],
        ["3", "ç¬¬3ç« ï¼šè§’è‰²åˆ†é…ï¼ˆè§’è‰²æç¤ºï¼‰", "ç« èŠ‚", ""],
        ["", "è¯¾ç¨‹", "è¯¾ç¨‹å†…å®¹", "å­¦ä¹ å¦‚ä½•ä¸ºClaudeåˆ†é…ç‰¹å®šè§’è‰²"],
        ["", "ç»ƒä¹ ", "å®è·µç»ƒä¹ ", "ç»ƒä¹ è§’è‰²åˆ†é…æŠ€å·§"],
        ["", "", "", ""],
        ["", "ä¸­çº§", "", ""],
        ["4", "ç¬¬4ç« ï¼šå°†æ•°æ®ä¸æŒ‡ä»¤åˆ†ç¦»", "ç« èŠ‚", ""],
        ["", "è¯¾ç¨‹", "è¯¾ç¨‹å†…å®¹", "å­¦ä¹ å¦‚ä½•æœ‰æ•ˆåˆ†ç¦»æ•°æ®å’ŒæŒ‡ä»¤"],
        ["", "ç»ƒä¹ ", "å®è·µç»ƒä¹ ", "ç»ƒä¹ æ•°æ®ä¸æŒ‡ä»¤åˆ†ç¦»æŠ€æœ¯"],
        ["5", "ç¬¬5ç« ï¼šæ ¼å¼åŒ–è¾“å‡ºå’Œä¸ºClaudeä»£è¨€", "ç« èŠ‚", ""],
        ["", "è¯¾ç¨‹", "è¯¾ç¨‹å†…å®¹", "å­¦ä¹ å¦‚ä½•æ§åˆ¶è¾“å‡ºæ ¼å¼"],
        ["", "ç»ƒä¹ ", "å®è·µç»ƒä¹ ", "ç»ƒä¹ æ ¼å¼åŒ–è¾“å‡ºæŠ€å·§"],
        ["6", "ç¬¬6ç« ï¼šé¢„è®¤çŸ¥ï¼ˆé€æ­¥æ€è€ƒï¼‰", "ç« èŠ‚", ""],
        ["", "è¯¾ç¨‹", "è¯¾ç¨‹å†…å®¹", "å­¦ä¹ å¦‚ä½•å¼•å¯¼Claudeé€æ­¥æ€è€ƒ"],
        ["", "ç»ƒä¹ ", "å®è·µç»ƒä¹ ", "ç»ƒä¹ é€æ­¥æ€è€ƒæŠ€æœ¯"],
        ["7", "ç¬¬7ç« ï¼šä½¿ç”¨ç¤ºä¾‹ï¼ˆå°æ ·æœ¬æç¤ºï¼‰", "ç« èŠ‚", ""],
        ["", "è¯¾ç¨‹", "è¯¾ç¨‹å†…å®¹", "å­¦ä¹ å¦‚ä½•ä½¿ç”¨ç¤ºä¾‹æå‡æ•ˆæœ"],
        ["", "ç»ƒä¹ ", "å®è·µç»ƒä¹ ", "ç»ƒä¹ å°æ ·æœ¬æç¤ºæŠ€æœ¯"],
        ["", "", "", ""],
        ["", "é«˜çº§", "", ""],
        ["8", "ç¬¬8ç« ï¼šé¿å…å¹»è§‰", "ç« èŠ‚", ""],
        ["", "è¯¾ç¨‹", "è¯¾ç¨‹å†…å®¹", "å­¦ä¹ å¦‚ä½•å‡å°‘AIå¹»è§‰ç°è±¡"],
        ["", "ç»ƒä¹ ", "å®è·µç»ƒä¹ ", "ç»ƒä¹ é¿å…å¹»è§‰çš„æŠ€å·§"],
        ["9", "ç¬¬9ç« ï¼šæ„å»ºå¤æ‚æç¤ºè¯ï¼ˆè¡Œä¸šç”¨ä¾‹ï¼‰", "ç« èŠ‚", ""],
        ["", "ä»é›¶å¼€å§‹æ„å»ºå¤æ‚æç¤ºè¯ - èŠå¤©æœºå™¨äºº", "è¯¾ç¨‹å†…å®¹", "å®é™…æ¡ˆä¾‹ï¼šèŠå¤©æœºå™¨äººæ„å»º"],
        ["", "æ³•å¾‹æœåŠ¡çš„å¤æ‚æç¤ºè¯", "è¯¾ç¨‹å†…å®¹", "å®é™…æ¡ˆä¾‹ï¼šæ³•å¾‹è¡Œä¸šåº”ç”¨"],
        ["", "ç»ƒä¹ ï¼šé‡‘èæœåŠ¡çš„å¤æ‚æç¤ºè¯", "å®è·µç»ƒä¹ ", "é‡‘èè¡Œä¸šåº”ç”¨ç»ƒä¹ "],
        ["", "ç»ƒä¹ ï¼šç¼–ç¨‹çš„å¤æ‚æç¤ºè¯", "å®è·µç»ƒä¹ ", "ç¼–ç¨‹é¢†åŸŸåº”ç”¨ç»ƒä¹ "],
        ["", "æ­å–œæ‚¨å®Œæˆè¯¾ç¨‹ & ä¸‹ä¸€æ­¥", "æ€»ç»“", "è¯¾ç¨‹æ€»ç»“å’Œåç»­å»ºè®®"],
        ["", "", "", ""],
        ["", "é™„å½•ï¼šè¶…è¶Šæ ‡å‡†æç¤º", "", ""],
        ["A1", "é“¾å¼æç¤º", "é«˜çº§æŠ€æœ¯", "å­¦ä¹ å¦‚ä½•é“¾æ¥å¤šä¸ªæç¤º"],
        ["A2", "å‡½æ•°è°ƒç”¨", "é«˜çº§æŠ€æœ¯", "å­¦ä¹ å¦‚ä½•ä½¿ç”¨å‡½æ•°è°ƒç”¨åŠŸèƒ½"],
        ["A3", "æœç´¢å’Œæ£€ç´¢", "é«˜çº§æŠ€æœ¯", "å­¦ä¹ æœç´¢å’Œæ£€ç´¢å¢å¼ºæŠ€æœ¯"],
        ["", "", "", ""],
        ["", "â†’ ç¬¬1ç« ï¼šåŸºæœ¬æç¤ºè¯ç»“æ„", "", ""]
    ]
    
    # åˆ›å»ºDataFrame
    df = pd.DataFrame(data, columns=["åºå·", "ç« èŠ‚å†…å®¹", "ç±»å‹", "è¯´æ˜"])
    
    # åˆ›å»ºExcelå·¥ä½œç°¿
    wb = openpyxl.Workbook()
    ws = wb.active
    ws.title = "Anthropicæç¤ºå·¥ç¨‹æ•™ç¨‹ç­”æ¡ˆé”®"
    
    # æ·»åŠ æ ‡é¢˜
    ws.merge_cells('A1:D1')
    ws['A1'] = '[ç­”æ¡ˆé”®] Anthropic æç¤ºå·¥ç¨‹äº¤äº’å¼æ•™ç¨‹ [å…¬å¼€è®¿é—®] - ä¸­æ–‡ç‰ˆ'
    title_font = Font(name='å¾®è½¯é›…é»‘', size=16, bold=True, color='1F497D')
    ws['A1'].font = title_font
    ws['A1'].alignment = Alignment(horizontal='center', vertical='center')
    ws.row_dimensions[1].height = 30
    
    # æ·»åŠ è­¦å‘Šä¿¡æ¯
    ws.merge_cells('A2:D2')
    ws['A2'] = 'æ³¨æ„ï¼šè¿™æ˜¯æ•™ç¨‹çš„éäº¤äº’å¼ç­”æ¡ˆé”®ï¼æ‚¨å°†æ— æ³•åœ¨æ­¤è¡¨æ ¼ä¸­ä¸Claudeè¿›è¡Œäº¤äº’ã€‚'
    warning_font = Font(name='å¾®è½¯é›…é»‘', size=10, color='D68910')
    warning_fill = PatternFill(start_color='FFF2CC', end_color='FFF2CC', fill_type='solid')
    ws['A2'].font = warning_font
    ws['A2'].fill = warning_fill
    ws['A2'].alignment = Alignment(horizontal='center', vertical='center')
    ws.row_dimensions[2].height = 25
    
    # æ·»åŠ è¡¨å¤´ï¼ˆä»ç¬¬4è¡Œå¼€å§‹ï¼‰
    headers = ["åºå·", "ç« èŠ‚å†…å®¹", "ç±»å‹", "è¯´æ˜"]
    for col, header in enumerate(headers, 1):
        cell = ws.cell(row=4, column=col, value=header)
        cell.font = Font(name='å¾®è½¯é›…é»‘', size=12, bold=True)
        cell.fill = PatternFill(start_color='E7E6E6', end_color='E7E6E6', fill_type='solid')
        cell.alignment = Alignment(horizontal='center', vertical='center')
    
    # æ·»åŠ æ•°æ®ï¼ˆä»ç¬¬5è¡Œå¼€å§‹ï¼‰
    for row_idx, row_data in enumerate(data, 5):
        for col_idx, value in enumerate(row_data, 1):
            cell = ws.cell(row=row_idx, column=col_idx, value=value)
            cell.font = Font(name='å¾®è½¯é›…é»‘', size=10)
            cell.alignment = Alignment(horizontal='left', vertical='center', wrap_text=True)
            
            # æ ¹æ®å†…å®¹ç±»å‹è®¾ç½®æ ·å¼
            if col_idx == 2 and value:  # ç« èŠ‚å†…å®¹åˆ—
                if "ç¬¬" in value and "ç« " in value:
                    cell.font = Font(name='å¾®è½¯é›…é»‘', size=11, bold=True)
                    cell.fill = PatternFill(start_color='E8F0FE', end_color='E8F0FE', fill_type='solid')
                elif value in ["åˆçº§", "ä¸­çº§", "é«˜çº§", "é™„å½•ï¼šè¶…è¶Šæ ‡å‡†æç¤º"]:
                    cell.font = Font(name='å¾®è½¯é›…é»‘', size=12, bold=True, color='1F497D')
                    cell.fill = PatternFill(start_color='D1E7DD', end_color='D1E7DD', fill_type='solid')
                    ws.merge_cells(f'A{row_idx}:D{row_idx}')
    
    # è®¾ç½®åˆ—å®½
    ws.column_dimensions['A'].width = 8
    ws.column_dimensions['B'].width = 50
    ws.column_dimensions['C'].width = 15
    ws.column_dimensions['D'].width = 30
    
    # æ·»åŠ è¾¹æ¡†
    thin_border = Border(
        left=Side(style='thin'),
        right=Side(style='thin'),
        top=Side(style='thin'),
        bottom=Side(style='thin')
    )
    
    for row in ws.iter_rows(min_row=4, max_row=ws.max_row, min_col=1, max_col=4):
        for cell in row:
            cell.border = thin_border
    
    # ä¿å­˜æ–‡ä»¶
    filename = "Anthropicæç¤ºå·¥ç¨‹æ•™ç¨‹ç­”æ¡ˆé”®_ä¸­æ–‡ç‰ˆ.xlsx"
    wb.save(filename)
    print(f"âœ… Excelæ–‡ä»¶å·²åˆ›å»ºï¼š{filename}")
    return filename

def main():
    """ä¸»å‡½æ•°"""
    print("ğŸš€ å¼€å§‹åˆ›å»ºAnthropicæç¤ºå·¥ç¨‹æ•™ç¨‹ç­”æ¡ˆé”®çš„Excelæ–‡ä»¶...")
    
    try:
        filename = create_excel_from_data()
        print(f"\nâœ… æˆåŠŸåˆ›å»ºExcelæ–‡ä»¶ï¼š{filename}")
        print(f"ğŸ“ æ–‡ä»¶ä½ç½®ï¼š{os.path.abspath(filename)}")
        print("\nğŸ“ ä½¿ç”¨è¯´æ˜ï¼š")
        print("1. åŒå‡»æ‰“å¼€Excelæ–‡ä»¶")
        print("2. å¯ä»¥ç›´æ¥ç¼–è¾‘å’Œæ‰“å°")
        print("3. å¯ä»¥å¯¼å…¥åˆ°Google Sheetsç­‰å…¶ä»–ç”µå­è¡¨æ ¼åº”ç”¨")
        
    except Exception as e:
        print(f"âŒ åˆ›å»ºExcelæ–‡ä»¶æ—¶å‡ºé”™ï¼š{e}")
        print("\nğŸ’¡ å¦‚æœç¼ºå°‘ä¾èµ–åº“ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š")
        print("pip install pandas openpyxl beautifulsoup4")

if __name__ == "__main__":
    main() 